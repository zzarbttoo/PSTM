<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="reviewmapper">
	<resultMap type="ReviewDto" id="ReviewDto">

		<result property="reviewid" column="REVIEWID" />
		<result property="userid" column="USERID" />
		<result property="reviewtitle" column="REVIEWTITLE" />
		<result property="reviewcontent" column="REVEIWCONTENT" />
		<result property="uploadimg" column="UPLOADIMG" />
		<result property="regdate" column="REGDATE" />
		<result property="trainerid" column="TRAINERID" />
		<result property="trainer" column="TRAINER" />
	</resultMap>

	<select id="selectList" resultMap="ReviewDto">
		SELECT REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE,
		TRAINERID, TRAINER
		FROM PSTM_REVIEWINFO
	</select>

	<insert id="insert" parameterType="ReviewDto">
		INSERT INTO PSTM_REVIEWINFO
		VALUES(PSTM_REVIEWIDSEQ.NEXTVAL,#{userid},#{reviewtitle},#{reviewcontent},
		#{uploadimg},SYSDATE,#{trainerid},#{trainer})
	</insert>

	<select id="selectOne" parameterType="int"
		resultType="ReviewDto">
		SELECT REVIEWID, USERID, REVIEWTITLE,
		REVIEWCONTENT,UPLOADIMG,REGDATE,TRAINER
		FROM PSTM_REVIEWINFO
		WHERE REVIEWID=#{reviewid}
	</select>

	<select id="selectsuch" parameterType="ReviewDto"
		resultType="ReviewDto">
		SELECT REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG,
		REGDATE, TRAINERID, TRAINER
		FROM PSTM_REVIEWINFO
		<where>
			<if test="reviewtitle!=null">
				REVIEWTITLE LIKE '%' || #{reviewtitle}|| '%'
			</if>
			<if test="trainer!=null">
				TRAINER LIKE '%' || #{trainer} || '%'
			</if>
		</where>
	</select>




	<update id="update" parameterType="ReviewDto">
		UPDATE PSTM_REVIEWINFO
		SET
		REVIEWTITLE=#{reviewtitle},TRAINER=#{trainer},REVIEWCONTENT=#{reviewcontent}
		WHERE REVIEWID=#{reviewid}
	</update>



	<delete id="delete" parameterType="int">
		DELETE FROM PSTM_REVIEWINFO WHERE REVIEWID=#{reviewid}
	</delete>

	<select id="selectReviewList" resultMap="ReviewDto">
		SELECT REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE,
		TRAINERID, TRAINER
		FROM PSTM_REVIEWINFO
	</select>

	<select id="selectReviewCount" resultType="int">
		SELECT COUNT(*) FROM PSTM_REVIEWINFO
	</select>

	<select id="selectReviewPaging" resultType="ReviewDto"
		parameterType="ReviewDto">
	
		  <![CDATA[ 
			SELECT REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE, TRAINERID, TRAINER
			FROM (SELECT SEQ, REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE, TRAINERID, TRAINER
			FROM (SELECT ROWNUM AS SEQ, REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE, TRAINERID, TRAINER
			FROM (SELECT * FROM PSTM_REVIEWINFO) ) 
			WHERE SEQ > #{offset})
			WHERE ROWNUM <= #{count} ]]>

	</select>



	<select id="selectsuchcount" parameterType="ReviewDto"
		resultType="int">
		SELECT COUNT(*)
		FROM PSTM_REVIEWINFO
		<where>
			<if test="reviewtitle!=null">
				REVIEWTITLE LIKE '%' || #{reviewtitle}|| '%'
			</if>
			<if test="trainer!=null">
				TRAINER LIKE '%' || #{trainer} || '%'
			</if>
		</where>
	</select>

	<select id="selectSuchPaging" resultType="ReviewDto"
		parameterType="ReviewDto">
	
		  <![CDATA[ 
			SELECT REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE, TRAINERID, TRAINER
			FROM (SELECT SEQ, REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE, TRAINERID, TRAINER
			FROM (SELECT ROWNUM AS SEQ, REVIEWID, USERID, REVIEWTITLE, REVIEWCONTENT, UPLOADIMG, REGDATE, TRAINERID, TRAINER
			FROM (SELECT * FROM PSTM_REVIEWINFO) ) 
			WHERE SEQ > #{offset})
			WHERE ROWNUM <= #{count}
			<where>
			<if test="reviewtitle!=null">
			 REVIEWTITLE LIKE '%' || #{reviewtitle}|| '%' 
			</if>
			<if test="trainer!=null">
			TRAINER LIKE '%' || #{trainer} || '%'
			</if>
			</where>]]>
			 

	</select>




</mapper>
